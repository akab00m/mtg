# –ê—É–¥–∏—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ MTG Proxy

**–î–∞—Ç–∞ –∞—É–¥–∏—Ç–∞:** 01.01.2026  
**–í–µ—Ä—Å–∏—è –ø—Ä–æ–µ–∫—Ç–∞:** v2 (—Ñ–æ—Ä–∫ ~4-–ª–µ—Ç–Ω–µ–π –¥–∞–≤–Ω–æ—Å—Ç–∏)  
**–¶–µ–ª—å:** –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç–∏, –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ MTProto proxy

---

## Executive Summary

MTG - —ç—Ç–æ –ª–µ–≥–∫–æ–≤–µ—Å–Ω—ã–π MTPROTO –ø—Ä–æ–∫—Å–∏ –¥–ª—è Telegram, —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π –Ω–∞ Go. –ü—Ä–æ–µ–∫—Ç –±—ã–ª —Ñ–æ—Ä–∫–Ω—É—Ç –æ–∫–æ–ª–æ 4 –ª–µ—Ç –Ω–∞–∑–∞–¥ –∏ —Ç—Ä–µ–±—É–µ—Ç —Å–µ—Ä—å–µ–∑–Ω–æ–π –º–æ–¥–µ—Ä–Ω–∏–∑–∞—Ü–∏–∏ –¥–ª—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–º —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ 2026 –≥–æ–¥–∞.

### –û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏: üü° –°–†–ï–î–ù–Ø–Ø (—Ç—Ä–µ–±—É–µ—Ç —É–ª—É—á—à–µ–Ω–∏–π)

### –û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏: üü¢ –•–û–†–û–®–ê–Ø (—Å –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª–æ–º –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏)

---

## üî¥ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ü–†–û–ë–õ–ï–ú–´ –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò

### 1. –£—Å—Ç–∞—Ä–µ–≤—à–∏–π math/rand.Seed (–í–´–°–û–ö–ò–ô –ü–†–ò–û–†–ò–¢–ï–¢)

**–§–∞–π–ª:** [main.go](main.go#L20)

```go
rand.Seed(time.Now().UTC().UnixNano())
```

**–ü—Ä–æ–±–ª–µ–º–∞:**

- `math/rand.Seed` deprecated —Å Go 1.20
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ —ç–Ω—Ç—Ä–æ–ø–∏–∏ –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ì–ü–°–ß
- –í Go 1.20+ `math/rand` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è –±–µ–∑–æ–ø–∞—Å–Ω–æ

**–†–∏—Å–∫:** –°–†–ï–î–ù–ò–ô - –ü—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ—Å—Ç—å –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è –∞—Ç–∞–∫ –Ω–∞ shuffle –≤ DNS resolver

**–†–µ—à–µ–Ω–∏–µ:**

```go
// –ü—Ä–æ—Å—Ç–æ —É–¥–∞–ª–∏—Ç—å - –∞–≤—Ç–æ–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤ Go 1.20+
// rand.Seed(time.Now().UTC().UnixNano())

// –ò–õ–ò –µ—Å–ª–∏ –Ω—É–∂–Ω–∞ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∞—è —Å—Ç–æ–π–∫–æ—Å—Ç—å:
// import "crypto/rand"
```

---

### 2. –ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—è: AES-CTR –±–µ–∑ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏

**–§–∞–π–ª:** [mtglib/internal/obfuscated2/utils.go](mtglib/internal/obfuscated2/utils.go#L9-L14)

```go
func makeAesCtr(key, iv []byte) cipher.Stream {
    block, err := aes.NewCipher(key)
    if err != nil {
        panic(err)
    }
    return cipher.NewCTR(block, iv)
}
```

**–ü—Ä–æ–±–ª–µ–º–∞:**

- AES-CTR –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –±–µ–∑ MAC (Message Authentication Code)
- –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∑–∞—â–∏—Ç–∞ –æ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –∞—Ç–∞–∫ (–ø–æ–¥–º–µ–Ω–∞, –∏–∑–º–µ–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö)
- –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç—ã —Ç—Ä–µ–±—É—é—Ç AEAD (Authenticated Encryption with Associated Data)

**–ö–æ–Ω—Ç–µ–∫—Å—Ç:**

- MTProto –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—É—é —Å—Ö–µ–º—É –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (HMAC-SHA256 –≤ faketls handshake)
- –ù–æ –Ω–∞ —É—Ä–æ–≤–Ω–µ obfuscated2 –Ω–µ—Ç —è–≤–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö –ø–æ—Å–ª–µ handshake

**–†–∏—Å–∫:** –í–´–°–û–ö–ò–ô - –í–æ–∑–º–æ–∂–Ω–∞ –∞—Ç–∞–∫–∞ —Ç–∏–ø–∞ bit-flipping, MITM

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**

1. –†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `cipher.NewGCM()` (AES-GCM) –¥–ª—è AEAD
2. –ï—Å–ª–∏ –ø—Ä–æ—Ç–æ–∫–æ–ª —Ç—Ä–µ–±—É–µ—Ç CTR - –¥–æ–±–∞–≤–∏—Ç—å HMAC-SHA256 –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–∞–∫–µ—Ç–∞
3. –°–≤–µ—Ä–∏—Ç—å —Å –∞–∫—Ç—É–∞–ª—å–Ω–æ–π —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–µ–π MTProto 2.0 (2026)

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –ù—É–∂–Ω–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ª–∏ MTProto —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—É—é —Å—Ö–µ–º—É –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø–æ–≤–µ—Ä—Ö obfuscated2.

---

### 3. Panic –≤ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –º–µ—Å—Ç–∞—Ö

**–ü—Ä–∏–º–µ—Ä—ã:**

- [mtglib/internal/obfuscated2/utils.go](mtglib/internal/obfuscated2/utils.go#L11): `panic(err)` –ø—Ä–∏ –æ—à–∏–±–∫–µ AES
- [mtglib/internal/obfuscated2/server_handshake.go](mtglib/internal/obfuscated2/server_handshake.go#L48): `panic(err)` –ø—Ä–∏ crypto/rand.Read
- [mtglib/stream_context.go](mtglib/stream_context.go#L64): `panic(err)` –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ streamID

**–ü—Ä–æ–±–ª–µ–º–∞:**

- Panic –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –ø–æ–ª–Ω–æ–º—É –ø–∞–¥–µ–Ω–∏—é –ø—Ä–æ–∫—Å–∏-—Å–µ—Ä–≤–µ—Ä–∞
- DoS –∞—Ç–∞–∫–∞ —á–µ—Ä–µ–∑ —Ç—Ä–∏–≥–µ—Ä panic –≤ –æ–±—Ä–∞–±–æ—Ç–∫–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π

**–†–∏—Å–∫:** –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –¥–ª—è production

**–†–µ—à–µ–Ω–∏–µ:**

```go
// –ü–õ–û–•–û
if err != nil {
    panic(err)
}

// –•–û–†–û–®–û
if err != nil {
    return fmt.Errorf("cannot create cipher: %w", err)
}
```

---

### 4. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ rate limiting –Ω–∞ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏—è—Ö

**–§–∞–π–ª:** [mtglib/internal/faketls/client_hello.go](mtglib/internal/faketls/client_hello.go#L43-L97)

**–ü—Ä–æ–±–ª–µ–º–∞:**

- –ü–∞—Ä—Å–∏–Ω–≥ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ ClientHello (HMAC-SHA256) –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –¥–ª—è –ö–ê–ñ–î–û–ì–û –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
- –ù–µ—Ç –∑–∞—â–∏—Ç—ã –æ—Ç CPU exhaustion –∞—Ç–∞–∫
- –ó–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –º–æ–∂–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Ç—ã—Å—è—á–∏ –Ω–µ–≤–∞–ª–∏–¥–Ω—ã—Ö handshakes

**–†–∏—Å–∫:** –í–´–°–û–ö–ò–ô - DoS —á–µ—Ä–µ–∑ –∏—Å—Ç–æ—â–µ–Ω–∏–µ CPU

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**

1. –î–æ–±–∞–≤–∏—Ç—å IP-based rate limiting –ü–ï–†–ï–î –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–º–∏ –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏
2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `golang.org/x/time/rate` –¥–ª—è throttling
3. –†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ PoW (Proof of Work) –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤

---

### 5. Constant-time —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ - —Ç–æ–ª—å–∫–æ —á–∞—Å—Ç–∏—á–Ω–æ

**–§–∞–π–ª:** [mtglib/internal/faketls/client_hello.go](mtglib/internal/faketls/client_hello.go#L83)

```go
if subtle.ConstantTimeCompare(clientHelloEmptyRandom[:RandomLen-4], 
                              computedRandom[:RandomLen-4]) != 1 {
    return hello, ErrBadDigest
}
```

**–•–æ—Ä–æ—à–æ:**

- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `subtle.ConstantTimeCompare` –¥–ª—è HMAC –ø—Ä–æ–≤–µ—Ä–∫–∏

**–ù–û:**

- –¢–æ–ª—å–∫–æ –¥–ª—è —á–∞—Å—Ç–∏ Random (RandomLen-4)
- Timestamp (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 4 –±–∞–π—Ç–∞) —Å—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç—Å—è –ù–ï constant-time –≤ `Valid()`

**–†–∏—Å–∫:** –ù–ò–ó–ö–ò–ô - –≤–æ–∑–º–æ–∂–Ω–∞ timing attack –Ω–∞ timestamp

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å constant-time –¥–ª—è –≤—Å–µ—Ö –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö —Å—Ä–∞–≤–Ω–µ–Ω–∏–π

---

## üü° –ü–†–û–ë–õ–ï–ú–´ –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò –°–†–ï–î–ù–ï–ì–û –ü–†–ò–û–†–ò–¢–ï–¢–ê

### 6. Context –±–µ–∑ —Ç–∞–π–º–∞—É—Ç–∞ –≤ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏—è—Ö

**–ü—Ä–∏–º–µ—Ä—ã:**

- [network/default.go](network/default.go#L18): `context.Background()` –±–µ–∑ timeout
- [mtglib/proxy.go](mtglib/proxy.go#L55): StreamContext —Å–æ–∑–¥–∞–µ—Ç—Å—è —Å cancel, –Ω–æ –±–µ–∑ deadline

**–ü—Ä–æ–±–ª–µ–º–∞:**

- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ç–∞–π–º–∞—É—Ç–æ–≤ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ resource exhaustion
- –ú–µ–¥–ª–µ–Ω–Ω—ã–µ –∫–ª–∏–µ–Ω—Ç—ã –º–æ–≥—É—Ç –∑–∞–Ω–∏–º–∞—Ç—å —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**

```go
// –î–æ–±–∞–≤–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä—É–µ–º—ã–µ —Ç–∞–π–º–∞—É—Ç—ã
ctx, cancel := context.WithTimeout(ctx, p.cfg.HandshakeTimeout)
defer cancel()
```

---

### 7. IP blocklist - –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å bypass

**–§–∞–π–ª:** [mtglib/proxy.go](mtglib/proxy.go#L113-L131)

```go
ipAddr := conn.RemoteAddr().(*net.TCPAddr).IP
// ... blocklist check ...
```

**–ü—Ä–æ–±–ª–µ–º–∞:**

- IP –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –ü–û–°–õ–ï Accept()
- –°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –Ω–∞ TCP —É—Ä–æ–≤–Ω–µ
- –ù–µ –∑–∞—â–∏—â–∞–µ—Ç –æ—Ç SYN flood

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**

1. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `SO_ATTACH_BPF` (Linux) –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –Ω–∞ —É—Ä–æ–≤–Ω–µ —è–¥—Ä–∞
2. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å iptables/nftables –¥–ª—è upstream —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
3. –î–æ–±–∞–≤–∏—Ç—å –≥–µ–æ–±–ª–æ–∫–∏—Ä–æ–≤–∫—É (GeoIP) –µ—Å–ª–∏ –ø—Ä–∏–º–µ–Ω–∏–º–æ

---

### 8. DNS-over-HTTPS –±–µ–∑ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤

**–§–∞–π–ª:** [network/dns_resolver.go](network/dns_resolver.go#L33-L60)

**–ü—Ä–æ–±–ª–µ–º–∞:**

- HTTP –∫–ª–∏–µ–Ω—Ç –º–æ–∂–µ—Ç –Ω–µ –ø—Ä–æ–≤–µ—Ä—è—Ç—å TLS —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã DoH —Å–µ—Ä–≤–µ—Ä–∞
- –ó–∞–≤–∏—Å–∏—Ç –æ—Ç –Ω–∞—Å—Ç—Ä–æ–µ–∫ `network.MakeHTTPClient()`

**–¢—Ä–µ–±—É–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏:** TLS –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è HTTP –∫–ª–∏–µ–Ω—Ç–∞

---

### 9. Anti-replay cache - Bloom Filter —Å limited retention

**–§–∞–π–ª:** [antireplay/stable_bloom_filter.go](antireplay/stable_bloom_filter.go#L17-L50)

```go
type stableBloomFilter struct {
    filter boom.StableBloomFilter
    mutex  sync.Mutex
}
```

**–ü—Ä–æ–±–ª–µ–º–∞:**

- Stable Bloom Filter –∏–º–µ–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—É—é –ø–∞–º—è—Ç—å
- False positive rate —Ä–∞—Å—Ç–µ—Ç —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º
- –í–æ–∑–º–æ–∂–Ω–∞ replay –∞—Ç–∞–∫–∞ –ø–æ—Å–ª–µ —Ä–æ—Ç–∞—Ü–∏–∏ —ç–ª–µ–º–µ–Ω—Ç–æ–≤

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**

1. –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å retention –ø–µ—Ä–∏–æ–¥ –∏ FP rate
2. –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ FP
3. –†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –∫–æ–º–±–∏–Ω–∞—Ü–∏—é Bloom + time-based window
4. –î–æ–±–∞–≤–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é —Ä–∞–∑–º–µ—Ä–∞ –∏ error rate

---

## üü¢ –ü–†–û–ë–õ–ï–ú–´ –ü–†–û–ò–ó–í–û–î–ò–¢–ï–õ–¨–ù–û–°–¢–ò

### 10. Sync.Pool –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ - —Ö–æ—Ä–æ—à–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞ ‚úÖ

**–ù–∞–π–¥–µ–Ω–æ 7 sync.Pool:**

- stats/pools.go - streamInfoPool
- mtglib/internal/obfuscated2/pools.go - sha256HasherPool, bytesBufferPool
- mtglib/internal/relay/pools.go - copyBufferPool
- mtglib/internal/faketls/pools.go - bytesBufferPool
- mtglib/internal/faketls/record/pools.go - recordPool

**–û—Ü–µ–Ω–∫–∞:** –û–¢–õ–ò–ß–ù–û - –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–ª—è —Å–Ω–∏–∂–µ–Ω–∏—è GC pressure

---

### 11. Worker pool –¥–ª—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ—Å—Ç–∏ ‚úÖ

**–§–∞–π–ª:** [mtglib/proxy.go](mtglib/proxy.go#L30)

```go
workerPool *ants.PoolWithFunc
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:** github.com/panjf2000/ants/v2

**–û—Ü–µ–Ω–∫–∞:** –•–û–†–û–®–û

- –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö goroutines
- –ó–∞—â–∏—â–∞–µ—Ç –æ—Ç goroutine exhaustion
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∞–∫—Ç—É–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è v2.11.4

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ pool utilization

---

### 12. Circuit Breaker –¥–ª—è –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏ ‚úÖ

**–§–∞–π–ª:** [network/circuit_breaker.go](network/circuit_breaker.go)

**–û—Ü–µ–Ω–∫–∞:** –û–¢–õ–ò–ß–ù–û

- –ó–∞—â–∏—Ç–∞ –æ—Ç –∫–∞—Å–∫–∞–¥–Ω—ã—Ö –æ—Ç–∫–∞–∑–æ–≤ –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö —Å Telegram DC
- –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ atomic –æ–ø–µ—Ä–∞—Ü–∏–π
- Half-open state –¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è

**–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:**

```go
// –ó–∞–º–µ–Ω–∞ mutex channel –Ω–∞ sync.Mutex –¥–ª—è –º–µ–Ω—å—à–µ–π latency
// stateMutexChan chan bool -> sync.Mutex
```

---

### 13. DNS Resolver —Å –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º

**–§–∞–π–ª:** [network/dns_resolver.go](network/dns_resolver.go#L15-L153)

**–•–æ—Ä–æ—à–æ:**

- –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ DNS –Ω–∞ 10 –º–∏–Ω—É—Ç
- DoH (DNS-over-HTTPS) –¥–ª—è –æ–±—Ö–æ–¥–∞ —Ü–µ–Ω–∑—É—Ä—ã
- –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ A/AAAA –∑–∞–ø—Ä–æ—Å—ã

**–ü—Ä–æ–±–ª–µ–º—ã:**

1. **–ö–µ—à –±–µ–∑ TTL –∏–∑ DNS –æ—Ç–≤–µ—Ç–∞** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è 10 –º–∏–Ω
2. **–ù–µ—Ç LRU eviction** - map —Ä–∞—Å—Ç–µ—Ç –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ
3. **RWMutex contention** - –ø—Ä–∏ –±–æ–ª—å—à–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –∑–∞–ø—Ä–æ—Å–æ–≤

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**

```go
// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≥–æ—Ç–æ–≤–æ–µ —Ä–µ—à–µ–Ω–∏–µ
// github.com/coredns/coredns/plugin/cache
// –ò–õ–ò
// github.com/miekg/dns + proper TTL handling
```

---

### 14. io.CopyBuffer —Å –±—É—Ñ–µ—Ä–∞–º–∏ –∏–∑ pool ‚úÖ

**–§–∞–π–ª:** [mtglib/internal/relay/relay.go](mtglib/internal/relay/relay.go#L41-L43)

```go
copyBuffer := acquireCopyBuffer()
defer releaseCopyBuffer(copyBuffer)
n, err := io.CopyBuffer(src, dst, *copyBuffer)
```

**–û—Ü–µ–Ω–∫–∞:** –û–¢–õ–ò–ß–ù–û - —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è –ø–µ—Ä–µ–¥–∞—á–∞ –¥–∞–Ω–Ω—ã—Ö —Å –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –±—É—Ñ–µ—Ä–æ–≤

---

### 15. –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª –¥–ª—è zero-copy —Å splice/sendfile

**–¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:** io.CopyBuffer (userspace –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ)

**–í–æ–∑–º–æ–∂–Ω–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:**

- Linux: `splice()` syscall –¥–ª—è zero-copy –º–µ–∂–¥—É sockets
- –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞: `github.com/panjf2000/gnet` –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ zero-copy

**–û—Ü–µ–Ω–∫–∞ –ø—Ä–∏—Ä–æ—Å—Ç–∞:** 10-20% CPU, 5-15% throughput –≤ high-traffic —Å—Ü–µ–Ω–∞—Ä–∏—è—Ö

---

## üîµ –ê–ö–¢–£–ê–õ–¨–ù–û–°–¢–¨ –ü–†–û–¢–û–ö–û–õ–ê MTPROTO

### MTProto 2.0 –≤ 2026 –≥–æ–¥—É

**–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ gotd/td (–æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è Go —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è):**

‚úÖ **–ü—Ä–æ—Ç–æ–∫–æ–ª —Å—Ç–∞–±–∏–ª–µ–Ω:**

- MTProto 2.0 –Ω–µ –º–µ–Ω—è–ª—Å—è –ø—Ä–∏–Ω—Ü–∏–ø–∏–∞–ª—å–Ω–æ —Å 2017 –≥–æ–¥–∞
- Obfuscated2 + FakeTLS –∞–∫—Ç—É–∞–ª—å–Ω—ã –≤ 2026
- Domain fronting –≤—Å–µ –µ—â–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è

‚ö†Ô∏è **–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –¥–µ—Ç–∞–ª—è—Ö:**

1. **–ù–æ–≤—ã–µ DC (Data Centers)** - –º–æ–≥—É—Ç –ø–æ—è–≤–∏—Ç—å—Å—è –Ω–æ–≤—ã–µ DC, –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å hardcoded DC list
2. **TLS fingerprinting evolution** - DPI —Å–∏—Å—Ç–µ–º—ã —Å—Ç–∞–ª–∏ —É–º–Ω–µ–µ, FakeTLS –º–æ–∂–µ—Ç —Ç—Ä–µ–±–æ–≤–∞—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
3. **QoS –∏ –ø—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏—è** - Telegram –¥–æ–±–∞–≤–∏–ª –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ —Ç—Ä–∞—Ñ–∏–∫–∞

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –°–≤–µ—Ä–∏—Ç—å —Ç–µ–∫—É—â—É—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é —Å `gotd/td v0.136.0` (–ø–æ—Å–ª–µ–¥–Ω—è—è –≤–µ—Ä—Å–∏—è –≤ go.mod)

---

## üü† –°–û–û–¢–í–ï–¢–°–¢–í–ò–ï GO BEST PRACTICES 2026

### 17. Go –≤–µ—Ä—Å–∏—è –≤ go.mod

**–§–∞–π–ª:** [go.mod](go.mod#L3)

```
go 1.24.11
```

**–û—Ü–µ–Ω–∫–∞:** ‚úÖ –í–µ—Ä—Å–∏—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** Go 1.24.11 —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –ø—Ä–æ–µ–∫—Ç–µ. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —Å–±–æ—Ä–∫–∏ –∏ CI/CD –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç —ç—Ç—É –≤–µ—Ä—Å–∏—é.

---

### 18. Error wrapping - —á–∞—Å—Ç–∏—á–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è

**–•–æ—Ä–æ—à–æ:**

```go
return fmt.Errorf("cannot dial: %w", err)
```

**–ü–ª–æ—Ö–æ:**

```go
return conn, err //nolint: wrapcheck
```

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –£–±—Ä–∞—Ç—å `//nolint: wrapcheck` –∏ –æ–±–æ—Ä–∞—á–∏–≤–∞—Ç—å –í–°–ï –æ—à–∏–±–∫–∏ —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º

---

### 19. Structured logging - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è zerolog ‚úÖ

**–§–∞–π–ª:** logger/zerolog.go

**–û—Ü–µ–Ω–∫–∞:** –•–û–†–û–®–û

- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π `github.com/rs/zerolog v1.34.0`
- Structured logging –¥–ª—è –ª—É—á—à–µ–π observability

---

## üìä –ó–ê–í–ò–°–ò–ú–û–°–¢–ò –ò CVE

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

1. **golang.org/x/crypto v0.46.0** ‚úÖ –ê–ö–¢–£–ê–õ–¨–ù–û (–ø—Ä–æ–≤–µ—Ä–µ–Ω–æ –≤ go.mod)
2. **golang.org/x/sys v0.39.0** ‚úÖ –ê–ö–¢–£–ê–õ–¨–ù–û (–ø—Ä–æ–≤–µ—Ä–µ–Ω–æ –≤ go.mod)
3. **github.com/gotd/td v0.136.0** ‚úÖ –ê–ö–¢–£–ê–õ–¨–ù–û (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è MTProto utils)

### –¢—Ä–µ–±—É—é—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ CVE

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å
go install golang.org/x/vuln/cmd/govulncheck@latest
govulncheck ./...
```

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:**

1. `govulncheck` - –ø—Ä–æ–≤–µ—Ä–∫–∞ CVE –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è—Ö
2. `gosec` - SAST –¥–ª—è Go
3. `nancy` (Sonatype) - dependency check
4. `trivy` - container scanning

---

## üéØ –ü–†–ò–û–†–ò–¢–ï–¢–ù–´–ô –ü–õ–ê–ù –ò–°–ü–†–ê–í–õ–ï–ù–ò–ô

### PHASE 1: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (1-2 –¥–Ω—è)

1. ‚úÖ –£–¥–∞–ª–∏—Ç—å `rand.Seed()` –∏–∑ main.go
2. ‚úÖ –ó–∞–º–µ–Ω–∏—Ç—å –≤—Å–µ `panic()` –Ω–∞ proper error handling
3. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å rate limiting –¥–ª—è hand—àake –æ–ø–µ—Ä–∞—Ü–∏–π
4. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å —Ç–∞–π–º–∞—É—Ç—ã –≤ –≤—Å–µ Context –æ–ø–µ—Ä–∞—Ü–∏–∏

### PHASE 2: –£–ª—É—á—à–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (3-5 –¥–Ω–µ–π)

1. –ê—É–¥–∏—Ç –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏–∏ - —Å–≤–µ—Ä–∫–∞ —Å MTProto 2.0 spec
2. –†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å AEAD –≤–º–µ—Å—Ç–æ CTR (–µ—Å–ª–∏ –ø—Ä–æ—Ç–æ–∫–æ–ª –ø–æ–∑–≤–æ–ª—è–µ—Ç)
3. –£–ª—É—á—à–∏—Ç—å anti-replay –º–µ—Ö–∞–Ω–∏–∑–º (–º–µ—Ç—Ä–∏–∫–∏, –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è)
4. –î–æ–±–∞–≤–∏—Ç—å IP rate limiting –Ω–∞ kernel level (iptables integration)
5. Constant-time —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –¥–ª—è –≤—Å–µ—Ö crypto –æ–ø–µ—Ä–∞—Ü–∏–π

### PHASE 3: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (5-7 –¥–Ω–µ–π)

1. –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å DNS resolver (TTL, LRU cache)
2. –†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å zero-copy —Å splice (Linux)
3. –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (Prometheus)
4. Load testing —Å —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–º —Ç—Ä–∞—Ñ–∏–∫–æ–º
5. –ü—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —Å pprof –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è hotspots

### PHASE 4: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ observability (2-3 –¥–Ω—è)

1. –î–æ–±–∞–≤–∏—Ç—å distributed tracing (OpenTelemetry)
2. –†–∞—Å—à–∏—Ä–∏—Ç—å –º–µ—Ç—Ä–∏–∫–∏ (pool utilization, error rates, latency percentiles)
3. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–ª–µ—Ä—Ç—ã –¥–ª—è security events
4. –î–æ–±–∞–≤–∏—Ç—å health checks –∏ readiness probes

---

## üõ†Ô∏è –ò–ù–°–¢–†–£–ú–ï–ù–¢–´ –î–õ–Ø –†–ê–ó–†–ê–ë–û–¢–ö–ò

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ tools

```bash
# –õ–∏–Ω—Ç–µ—Ä—ã –∏ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑
golangci-lint run --enable-all

# –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
gosec ./...
govulncheck ./...

# –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
go test -bench=. -benchmem
go test -cpuprofile=cpu.prof -memprofile=mem.prof

# –ü–æ–∫—Ä—ã—Ç–∏–µ
go test -coverprofile=coverage.out ./...
go tool cover -html=coverage.out
```

### CI/CD Pipeline additions

1. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π `govulncheck` –Ω–∞ –∫–∞–∂–¥—ã–π PR
2. Benchmark regression testing
3. Security scanning —Å Trivy/Snyk
4. SAST —Å gosec
5. License compliance check

---

## üìà –ú–ï–¢–†–ò–ö–ò –î–õ–Ø –ú–û–ù–ò–¢–û–†–ò–ù–ì–ê

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –º–µ—Ç—Ä–∏–∫–∏

**–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:**

- `mtg_blocked_ips_total` - –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ IP
- `mtg_replay_attacks_total` - –æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ replay
- `mtg_invalid_handshakes_total` - –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–µ handshakes
- `mtg_rate_limited_total` - rate limited –∑–∞–ø—Ä–æ—Å—ã

**–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:**

- `mtg_active_connections` - —Ç–µ–∫—É—â–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
- `mtg_worker_pool_utilization` - –∑–∞–≥—Ä—É–∑–∫–∞ worker pool
- `mtg_handshake_duration_seconds` - –ª–∞—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å handshake
- `mtg_bytes_transferred_total` - –æ–±—ä–µ–º –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- `mtg_dns_cache_hit_ratio` - —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å DNS –∫–µ—à–∞

**Availability:**

- `mtg_circuit_breaker_state` - —Å–æ—Å—Ç–æ—è–Ω–∏–µ circuit breaker
- `mtg_telegram_dc_latency_seconds` - –ª–∞—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –¥–æ Telegram DC
- `mtg_errors_total` (by type) - –æ—à–∏–±–∫–∏ –ø–æ —Ç–∏–ø–∞–º

---

## üéì –í–´–í–û–î–´

### –°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã

‚úÖ –ß–∏—Å—Ç–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ–º concerns  
‚úÖ –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ sync.Pool –∏ worker pools  
‚úÖ Circuit breaker –¥–ª—è –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏  
‚úÖ –ê–∫—Ç—É–∞–ª—å–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (crypto, net)  
‚úÖ DoH –¥–ª—è DNS - —Ö–æ—Ä–æ—à–æ –¥–ª—è –æ–±—Ö–æ–¥–∞ —Ü–µ–Ω–∑—É—Ä—ã  
‚úÖ Structured logging  

### –°–ª–∞–±—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã

‚ùå –£—Å—Ç–∞—Ä–µ–≤—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ (rand.Seed, panic)  
‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ rate limiting –Ω–∞ crypto –æ–ø–µ—Ä–∞—Ü–∏—è—Ö  
‚ùå –ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—è –±–µ–∑ AEAD (–Ω—É–∂–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞)  
‚ùå DNS –∫–µ—à –±–µ–∑ TTL –∏ LRU  
‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ–∫ observability (–º–µ—Ç—Ä–∏–∫, —Ç—Ä–µ–π—Å–∏–Ω–≥–∞)  
  
### –û–±—â–∞—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è

**–ü—Ä–æ–µ–∫—Ç —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–µ–Ω, –Ω–æ —Ç—Ä–µ–±—É–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–ª—è production use –≤ 2026.**

–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: **PHASE 1 (–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å) ‚Üí PHASE 4 (monitoring) ‚Üí PHASE 2 ‚Üí PHASE 3**

–û–∂–∏–¥–∞–µ–º–æ–µ –≤—Ä–µ–º—è –Ω–∞ –ø–æ–ª–Ω—É—é –º–æ–¥–µ—Ä–Ω–∏–∑–∞—Ü–∏—é: **2-3 –Ω–µ–¥–µ–ª–∏** (—Å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º)

---

## üìö –ü–û–õ–ï–ó–ù–´–ï –†–ï–°–£–†–°–´

1. [MTProto 2.0 Specification](https://core.telegram.org/mtproto)
2. [gotd/td - Reference implementation](https://github.com/gotd/td)
3. [OWASP Go Security Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Go_SCP.pdf)
4. [Go Cryptography Guide 2025](https://pkg.go.dev/crypto)
5. [Google Go Style Guide](https://google.github.io/styleguide/go/)

---

**–ü–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–æ:** AI Security Auditor  
**–î–∞—Ç–∞:** 01.01.2026  
**–°—Ç–∞—Ç—É—Å:** PRELIMINARY AUDIT - —Ç—Ä–µ–±—É–µ—Ç—Å—è manual review –∏ security testing
